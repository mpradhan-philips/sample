    $testProc = execNunit -ExePath "C:\Program Files\NCover Desktop\NCover.exe" -test $test1 -Params $args
    Write-Host "Ncover Export Exit Code:$testProc"

    try {
        # Check if the report file exists and is not empty
        if (Test-Path -Path $resFile) {
            $fileInfo = Get-Item -Path $resFile
            if ($fileInfo.Length -gt 0) {
                Write-Host "Report found and is not empty, copying to shared path..."
                
                # Create shared path including project directory   
                if (-not (Test-Path -Path $dstPath)) {
                    Write-Host "Creating directory: $dstPath"
                    New-Item -ItemType Directory -Path "$dstPath" -Force |Out-Null
                }
                 
                $DestinationPath = Join-Path -Path $dstPath -ChildPath "$NcoverProject.xml"
    
                # Copy the report to the shared path
                Copy-Item -Path $resFile -Destination $DestinationPath -Force -ErrorAction Stop
                if ($LASTEXITCODE -eq 0) {
                    Write-Host "Report successfully copied to shared path : $DestinationPath "
                } else {
                    Write-Host "Failed to copy report to shared path."
                }
            } else {
                Write-Host "Report is empty (0 KB), skipping copy."
            }
        } else {
            Write-Host "Report not found at $resFile."
            exit 1
        }
    } catch {
        Write-Host "An error occurred: $_"
        exit 1
    }
